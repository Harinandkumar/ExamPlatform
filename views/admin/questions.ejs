<!DOCTYPE html>
<html lang="en">
<%- include('../partials/head') %>
<!-- Highlight.js CSS -->
<link rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
<link id="hljs-theme" rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">

<body class="bg-gray-100 min-h-screen font-sans">
<!-- Fixed Theme Button -->
<div class="fixed top-4 right-4 z-50">
  <!-- Main Button -->
  <button id="themeBtn" 
          class="bg-blue-500 text-white px-4 py-2 rounded-full hover:bg-blue-600 transition-colors shadow-lg">
    Theme
  </button>

  <!-- Popup Buttons -->
  <div id="themePopup" class="hidden mt-2 flex flex-wrap gap-2 p-2 bg-white shadow-lg rounded-lg w-48">
    <button class="theme-btn w-8 h-8 rounded-full shadow" style="background:#f5f5f5; border:1px solid #ccc;" data-theme="github"></button>
    <button class="theme-btn w-8 h-8 rounded-full shadow" style="background:#0d1117; border:1px solid #333;" data-theme="github-dark"></button>
    <button class="theme-btn w-8 h-8 rounded-full shadow" style="background:#282c34;" data-theme="atom-one-dark"></button>
    <button class="theme-btn w-8 h-8 rounded-full shadow" style="background:#fafafa; border:1px solid #ccc;" data-theme="atom-one-light"></button>
    <button class="theme-btn w-8 h-8 rounded-full shadow" style="background:#272822;" data-theme="monokai"></button>
    <button class="theme-btn w-8 h-8 rounded-full shadow" style="background:#282a36;" data-theme="dracula"></button>
    <button class="theme-btn w-8 h-8 rounded-full shadow" style="background:#002b36;" data-theme="solarized-dark"></button>
    <button class="theme-btn w-8 h-8 rounded-full shadow" style="background:#fdf6e3; border:1px solid #ccc;" data-theme="solarized-light"></button>
  </div>
</div>




  <div class="max-w-4xl mx-auto py-10 px-4">
    <%- include('../partials/nav') %>

    <h1 class="text-3xl font-bold text-gray-800 mb-6">Questions - <%= exam.title %></h1>

    <!-- Add Question Form -->
    <form method="post" action="/admin/exams/<%= exam._id %>/questions" class="bg-white shadow-md rounded-lg p-6 mb-10">
      <h3 class="text-xl font-semibold mb-4">Add Question</h3>

      <textarea name="text" placeholder="Question text" required
        class="w-full border rounded-lg p-2 mb-4 focus:outline-none focus:ring-2 focus:ring-blue-400"></textarea>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
        <div>
          <label class="block text-gray-700 mb-1">Option 1:</label>
          <input name="choice1" required
            class="w-full border rounded-lg p-2 focus:outline-none focus:ring-2 focus:ring-blue-400" />
        </div>
        <div>
          <label class="block text-gray-700 mb-1">Option 2:</label>
          <input name="choice2" required
            class="w-full border rounded-lg p-2 focus:outline-none focus:ring-2 focus:ring-blue-400" />
        </div>
        <div>
          <label class="block text-gray-700 mb-1">Option 3:</label>
          <input name="choice3" required
            class="w-full border rounded-lg p-2 focus:outline-none focus:ring-2 focus:ring-blue-400" />
        </div>
        <div>
          <label class="block text-gray-700 mb-1">Option 4:</label>
          <input name="choice4" required
            class="w-full border rounded-lg p-2 focus:outline-none focus:ring-2 focus:ring-blue-400" />
        </div>
      </div>

      <label class="block text-gray-700 mb-1">Correct Option (1-4):</label>
      <input type="number" name="answer" min="1" max="4" required
        class="w-20 border rounded-lg p-2 mb-4 focus:outline-none focus:ring-2 focus:ring-blue-400" />

      <button type="submit"
        class="bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition-colors">Add Question</button>
    </form>

    <!-- Existing Questions -->
    <ul class="space-y-4">
      <% questions.forEach(q => { %>
        <li class="bg-white shadow-md rounded-lg p-4 flex justify-between items-center">
          <span>
  <pre><code class="language-c"><%- q.text.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;") %></code></pre>

</span>

          <form method="post" action="/admin/questions/<%= q._id %>?_method=DELETE"
            onsubmit="return confirm('Are you sure you want to delete this question?');">
            <button type="submit"
              class="bg-red-500 text-white px-3 py-1 rounded-lg hover:bg-red-600 transition-colors">
              Delete
            </button>
          </form>
        </li>
      <% }) %>
    </ul>

  </div>
<!-- Highlight.js JS -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/c.min.js"></script>
<script>hljs.highlightAll();</script>
<script>
const themeLink = document.getElementById("hljs-theme");
const themeBtn = document.getElementById("themeBtn");
const themePopup = document.getElementById("themePopup");
const themeButtons = document.querySelectorAll(".theme-btn");

// Load saved theme
const savedTheme = localStorage.getItem("hljs-theme");
if(savedTheme) themeLink.href = `https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/${savedTheme}.min.css`;

// Toggle popup on main button click
themeBtn.addEventListener("click", (e) => {
  e.stopPropagation();
  themePopup.classList.toggle("hidden");
});

// Change theme on button click
themeButtons.forEach(btn => {
  btn.addEventListener("click", () => {
    const theme = btn.dataset.theme;
    themeLink.href = `https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/${theme}.min.css`;
    localStorage.setItem("hljs-theme", theme);
    hljs.highlightAll();
    themePopup.classList.add("hidden"); // close popup
  });
});

// Close popup if clicked outside
document.body.addEventListener("click", () => {
  themePopup.classList.add("hidden");
});


</script>
</body>
</html>
